(function(t){function e(e){for(var i,s,o=e[0],c=e[1],u=e[2],d=0,h=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(h.length)h.shift()();return n.push.apply(n,u||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var c=a[o];0!==r[c]&&(i=!1)}i&&(n.splice(e--,1),t=s(s.s=a[0]))}return t}var i={},r={app:0},n=[];function s(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=i,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/weather-api/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},3820:function(t,e,a){"use strict";a("944c")},4844:function(t,e,a){},"550b":function(t,e,a){"use strict";a("adb6")},"56d7":function(t,e,a){"use strict";a.r(e);a("0643"),a("2382");var i=a("2b0e"),r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app",attrs:{id:"app"}},[e("div",{staticClass:"layout-card"},[e("div",{staticClass:"card"},[e("WeatherSearch"),t.getBusy?e("div",{staticClass:"download"},[e("strong",[t._v("Загрузка...")])]):t._e(),t.getError&&!t.getBusy?e("div",{staticClass:"error"},[t._v("Не удалось получить ответ от API. Попробуйте позже.")]):t._e(),e("WeatherMain"),e("WeatherInfo"),e("WeatherFuture")],1),t._m(0)])])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"spliter"},[e("img")])}],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"weather-search"},[e("div",{staticClass:"combo-box"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.search,expression:"search",modifiers:{trim:!0}}],staticClass:"search-control",attrs:{type:"text",placeholder:"Найти город"},domProps:{value:t.search},on:{input:[function(e){e.target.composing||(t.search=e.target.value.trim())},t.debounceGetHints],keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getData.apply(null,arguments)},blur:[t.clearHints,function(e){return t.$forceUpdate()}]}}),t.hints.length>0?e("ul",{staticClass:"hints-list"},t._l(t.hints,(function(a,i){var r;return e("li",{key:i,staticClass:"hint-item",on:{click:function(e){var i;return t.selectHint(null!==(i=null===a||void 0===a?void 0:a.local_names["ru"])&&void 0!==i?i:a.name)}}},[t._v(" "+t._s(`${null!==(r=null===a||void 0===a?void 0:a.local_names["ru"])&&void 0!==r?r:a.name} (${a.country})`)+" ")])})),0):t._e()]),t.isSearched?e("span",{staticClass:"country"},[t._v("("+t._s(t.getWeatherCountry)+")")]):t._e()])},o=[],c=a("2f62"),u={data(){return{search:"",hints:[],timeout:null}},computed:{...Object(c["c"])(["isSearched","getWeatherCountry","getError"])},methods:{...Object(c["b"])(["fetchWeatherData","fetchHints"]),async getHints(){try{const t=await this.fetchHints(this.search);this.hints=t.hints}catch(t){console.error(t)}},debounceGetHints(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.search?this.getHints(this.search):this.hints=[]},500)},selectHint(t){this.search=t,this.clearHints(),this.getData()},getData(){this.fetchWeatherData(this.search)},clearHints(){setTimeout(()=>{this.hints=[]},200)}}},l=u,d=(a("858d"),a("2877")),h=Object(d["a"])(l,s,o,!1,null,null,null),p=h.exports,f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"weather-main"},[e("div",{staticClass:"weather-feelsLike"},[t._v(" Погода в "),e("strong",[t._v(" "+t._s(t.getWeatherMain.city)+" ")])]),e("div",{staticClass:"weather-feelsLike"},[t._v(" Ощущается как "),e("strong",[t._v(" "+t._s(t._f("round")(t.getWeatherMain.feelsLike))+" "),e("sup",[t._v("°")])])]),e("div",{staticClass:"weather-temp"},[e("div",{staticClass:"weather-icon",style:[t.getWeatherMain.icon?{"background-image":"url(http://openweathermap.org/img/wn/"+t.getWeatherMain.icon+"d@2x.png)"}:{}]}),e("span",[t._v(t._s(t._f("round")(t.getWeatherMain.temp)))]),e("sup",[t._v("°")])]),e("div",{staticClass:"weather-description"},[t._v(t._s(t.getWeatherMain.description))]),e("p")])},m=[],v={data(){return{}},computed:{...Object(c["c"])(["getWeatherMain"])}},_=v,g=(a("8509"),Object(d["a"])(_,f,m,!1,null,"0c9b932b",null)),y=g.exports,w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"weather-info"},[e("div",{staticClass:"weather-item",attrs:{title:"Скорость ветра"}},[e("windIcon",{attrs:{size:"1.1x"}}),e("span",{staticClass:"value"},[t._v(t._s(t.getWeatherInfo.wind)+" м/с")])],1),e("div",{staticClass:"weather-item",attrs:{title:"Направление ветра"}},[e("ArrowRightIcon",{attrs:{size:"1.1x"}}),e("span",{staticClass:"value"},[t._v(t._s(t.getWeatherInfo.windDirection)),e("b",[t._v("°")])])],1),e("div",{staticClass:"weather-item",attrs:{title:"Влажность"}},[e("DropletIcon",{attrs:{size:"1.1x"}}),e("span",{staticClass:"value"},[t._v(t._s(t.getWeatherInfo.humidity)+"%")])],1),e("div",{staticClass:"weather-item",attrs:{title:"Облачность"}},[e("CloudIcon",{attrs:{size:"1.1x"}}),e("span",{staticClass:"value"},[t._v(t._s(t.getWeatherInfo.clouds)+"%")])],1),e("div",{staticClass:"weather-item",attrs:{title:"Давление"}},[e("DownloadCloudIcon",{attrs:{size:"1.1x"}}),e("span",{staticClass:"value"},[t._v(t._s(t.getWeatherInfo.pressure)+" мм. рт. ст.")])],1)])},b=[],C=a("0a35"),D={components:{WindIcon:C["e"],DropletIcon:C["d"],CloudIcon:C["b"],DownloadCloudIcon:C["c"],ArrowRightIcon:C["a"]},computed:{...Object(c["c"])(["getWeatherInfo"])}},W=D,E=(a("550b"),Object(d["a"])(W,w,b,!1,null,"71d22ea1",null)),S=E.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"future"},t._l(t.getWeatherDaily,(function(a,i){return e("div",{key:i,staticClass:"future__item"},[e("div",[t._v(t._s(a.day))]),e("div",{staticClass:"future__right"},[e("img",{staticClass:"future__icon",style:[a.icon?{content:"url(http://openweathermap.org/img/wn/"+a.icon+"d@2x.png)"}:{}]}),e("div",[t._v(t._s(a.temp>0?"+":"")),e("strong",[t._v(t._s(a.temp))])])])])})),0)},x=[],I={data(){return{}},computed:{...Object(c["c"])(["getWeatherDaily"])}},T=I,j=(a("3820"),Object(d["a"])(T,O,x,!1,null,null,null)),M=j.exports,k={name:"App",components:{WeatherSearch:p,WeatherMain:y,WeatherInfo:S,WeatherFuture:M},computed:{...Object(c["c"])(["getBusy","getError"])},methods:{...Object(c["b"])(["fetchWeatherData"]),initData(){this.fetchWeatherData(this.$store.state.defaultSearch)}},created(){this.initData()}},A=k,H=(a("d760"),Object(d["a"])(A,r,n,!1,null,null,null)),R=H.exports,B=(a("d9e2"),a("1e70"),a("79a4"),a("c1a1"),a("8b00"),a("a4e7"),a("1e5a"),a("72c3"),a("a573"),a("bc3a")),P=a.n(B);i["a"].use(c["a"]);const $=new c["a"].Store({state:{apiBase:"https://api.openweathermap.org/data/2.5/",apiKey:"6ae66b5a75956d04b2bab4de20cb2225",defaultSearch:"Нижний Тагил",search:"",isError:!1,isBusy:!1,dailyData:[{day:"Нет",temp:0,icon:null},{day:"Нет",temp:0,icon:null},{day:"Нет",temp:0,icon:null}],weatherData:{name:"Нет",temp:0,tempMin:0,tempMax:0,feelsLike:0,description:"Нет",icon:null,info:"Rain",wind:0,humidity:0,clouds:0,country:"NO",pressure:0,windDirection:0,city:"Нет"}},getters:{getWeatherMain(t){const{temp:e,feelsLike:a,description:i,icon:r,info:n,city:s}=t.weatherData;return{temp:e,feelsLike:a,description:i,info:n,icon:r,city:s}},getWeatherInfo(t){const{wind:e,clouds:a,humidity:i,pressure:r,windDirection:n}=t.weatherData;return{wind:e,clouds:a,humidity:i,pressure:r,windDirection:n}},getWeatherDaily(t){return t.dailyData},getWeatherCountry(t){return t.weatherData.country},isSearched(t){return""!==t.search},getError(t){return t.isError},getBusy(t){return t.isBusy},isFirstLoad(t){t.weather.name}},mutations:{["SET_SEARCH"](t,e){t.search=e.toLowerCase()},["SET_WEATHER_DATA"](t,e){t.weatherData=e},["SET_DAILY_DATA"](t,e){t.dailyData=e},["SET_ERROR"](t,e){t.isError=e},["SET_BUSY"](t,e){t.isBusy=e}},actions:{async fetchWeatherData({commit:t,state:e},a){try{var i;t("SET_SEARCH",a),t("SET_BUSY",!0);const r=await P()({method:"get",url:`${e.apiBase}weather?q=${a}&units=metric&APPID=${e.apiKey}&lang=ru`,timeout:5e3}),n=await P()({method:"get",url:`${e.apiBase}forecast?q=${a}&units=metric&APPID=${e.apiKey}&lang=ru`,timeout:5e3});if(200!==r.status||200!==n.status)throw console.log(r),new Error;const s={name:r.data.name,temp:r.data.main.temp,tempMin:r.data.main.temp_min,tempMax:r.data.main.temp_max,feelsLike:r.data.main.feels_like,description:r.data.weather[0].description,icon:r.data.weather[0].icon.substring(0,2),info:r.data.weather[0].main,wind:r.data.wind.speed,humidity:r.data.main.humidity,clouds:r.data.clouds.all,country:r.data.sys.country,pressure:(r.data.main.pressure/1.333).toFixed(0),windDirection:r.data.wind.deg,city:a},o=new Set;console.log(n);const c=null===(i=n.data.list)||void 0===i?void 0:i.map(t=>({day:t.dt_txt,temp:t.main.temp,icon:t.weather[0].icon.substring(0,2)})).filter(t=>{console.log(t,t.day);const e=t.day.substring(0,10),a=Number(t.day.substring(11,13));return!o.has(e)&&(a>=15&&(o.add(e),!0))}).filter((t,e)=>{if(0==e)return!1;if(1==e)t.day="Завтра";else if(2==e)t.day="Послезавтра";else{const e=t.day.substring(0,10);t.day=e}return!0});console.log(c),t("SET_WEATHER_DATA",s),t("SET_DAILY_DATA",c),t("SET_ERROR",!1)}catch(r){console.log(r),t("SET_ERROR",!0)}finally{t("SET_BUSY",!1)}},async fetchHints({state:t},e){try{const a=await P()({method:"get",url:`https://api.openweathermap.org/geo/1.0/direct?q=${e}&limit=1&appid=${t.apiKey}`,timeout:5e3});if(200!==a.status)throw console.log(a),new Error;const i=await a.data;return{success:!0,hints:null!==i&&void 0!==i?i:[]}}catch(a){return console.log(a),[]}}}});var L=$;i["a"].config.productionTip=!1,i["a"].filter("round",(function(t,e){return t||(t=0),e||(e=0),t=Math.round(t*Math.pow(10,e))/Math.pow(10,e),t})),new i["a"]({store:L,render:t=>t(R)}).$mount("#app")},"59d6":function(t,e,a){},8509:function(t,e,a){"use strict";a("4844")},"858d":function(t,e,a){"use strict";a("bf30")},"944c":function(t,e,a){},adb6:function(t,e,a){},bf30:function(t,e,a){},d760:function(t,e,a){"use strict";a("59d6")}});
//# sourceMappingURL=app.b24db442.js.map